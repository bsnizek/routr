<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>

    <!-- build:css styles/vendor.css -->
    <!-- bower:css -->
    <link rel="stylesheet" href="../../static/bower_components/leaflet-dist/leaflet.css" />
    <link rel="stylesheet" href="../../static/bower_components/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="../../static/bower_components/leaflet-sidebar/src/L.Control.Sidebar.css" />
    <link rel="stylesheet" href="../../static/bower_components/leaflet-easybutton/src/easy-button.css" />
    <link rel="stylesheet" href="../../static/bower_components/leaflet-draw/dist/leaflet.draw.css" />
    <link rel="stylesheet" href="../../static/bower_components/leaflet-search/dist/leaflet-search.src.css" />
    <!-- endbower -->
    <!-- endbuild -->

    <link rel="stylesheet" href="../static/dist/informal-routr.css">
    <link rel="shortcut icon" type="image/x-icon" href="static/favicon.png" />

</head>
<body>

<div id="sidebar"></div>

<div id="map"></div>

<div id="thank-you" class="leaflet-sidebar"></div>

<script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>

<!-- build:js scripts/vendor.js -->
<!-- bower:js -->
<script src="../../static/bower_components/jquery/dist/jquery.js"></script>
<script src="../../static/bower_components/bootstrap/dist/js/bootstrap.js"></script>
<script src="../../static/bower_components/showdown/dist/showdown.js"></script>
<script src="../../static/bower_components/leaflet-dist/leaflet.js"></script>
<script src="../../static/bower_components/leaflet/dist/leaflet-src.js"></script>
<script src="../../static/bower_components/leaflet-sidebar/src/L.Control.Sidebar.js"></script>
<script src="../../static/bower_components/leaflet-easybutton/src/easy-button.js"></script>
<script src="../../static/bower_components/leaflet-draw/dist/leaflet.draw-src.js"></script>
<script src="../../static/bower_components/leaflet-search/dist/leaflet-search.src.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Distance.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Layers.Load.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Permalink.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Permalink.Layer.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Permalink.Line.js"></script>
<script src="../../static/bower_components/leaflet-plugins/control/Permalink.Marker.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/Icon.Canvas.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/Layer.Deferred.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/Marker.Rotate.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/Marker.Text.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/OpenStreetBugs.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/vector/GPX.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/vector/GPX.Speed.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/vector/KML.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/vector/OSM.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/tile/Bing.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/tile/Google.js"></script>
<script src="../../static/bower_components/leaflet-plugins/layer/tile/Yandex.js"></script>
<script src="../../static/bower_components/leaflet.editable/src/Leaflet.Editable.js"></script>
<!-- endbower -->
<!-- endbuild -->


<script src="../static/informal-routr.min.js"></script>

<script>

    var user_id = '{{ user_id}}';

    function getStyles() {
        return [
            {
                "featureType":"administrative",
                "elementType":"geometry.stroke",
                "stylers":[{"visibility":"on"},
                    {"color":"#ababab"}
                ]},
            {"featureType":"administrative",
                "elementType":"labels.text.fill",
                "stylers":[{"color":"#444444"}]},{"featureType":"administrative.country","elementType":"geometry.stroke","stylers":[{"lightness":"59"}]},{"featureType":"administrative.country","elementType":"labels.text","stylers":[{"lightness":"50"},{"color":"#7e7e85"},{"weight":"0.21"}]},{"featureType":"administrative.province","elementType":"geometry.stroke","stylers":[{"weight":"0.5"},{"color":"#afafaf"},{"visibility":"on"}]},{"featureType":"administrative.province","elementType":"labels.text","stylers":[{"visibility":"off"},{"color":"#7e7e85"}]},{"featureType":"administrative.province","elementType":"labels.text.fill","stylers":[{"color":"#7e7e85"}]},{"featureType":"administrative.locality","elementType":"labels.text","stylers":[{"visibility":"on"},{"lightness":"59"}]},{"featureType":"administrative.locality","elementType":"labels.text.fill","stylers":[{"lightness":"-39"}]},{"featureType":"administrative.locality","elementType":"labels.icon","stylers":[{"lightness":"48"},{"visibility":"on"}]},{"featureType":"administrative.neighborhood","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"administrative.land_parcel","elementType":"geometry.stroke","stylers":[{"visibility":"off"},{"color":"#c4c4c7"}]},{"featureType":"administrative.land_parcel","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"landscape","elementType":"all","stylers":[{"color":"#f2f2f2"}]},{"featureType":"landscape.natural.terrain","elementType":"labels.text","stylers":[{"color":"#ff0000"},{"visibility":"off"}]},{"featureType":"poi","elementType":"all","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"all","stylers":[{"saturation":-100},{"lightness":45}]},{"featureType":"road.highway","elementType":"all","stylers":[{"visibility":"on"}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#eaeaea"},{"weight":".5"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"weight":".75"},{"color":"#e4e3e3"}]},{"featureType":"road.highway","elementType":"labels","stylers":[{"visibility":"on"},{"lightness":"20"}]},{"featureType":"road.highway","elementType":"labels.text.fill","stylers":[{"visibility":"on"}]},{"featureType":"road.highway","elementType":"labels.text.stroke","stylers":[{"weight":"0.49"}]},{"featureType":"road.arterial","elementType":"all","stylers":[{"visibility":"on"}]},{"featureType":"road.arterial","elementType":"labels.text","stylers":[{"visibility":"on"}]},{"featureType":"road.arterial","elementType":"labels.text.fill","stylers":[{"lightness":"43"}]},{"featureType":"road.arterial","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"road.local","elementType":"all","stylers":[{"visibility":"on"}]},{"featureType":"road.local","elementType":"geometry.stroke","stylers":[{"visibility":"on"},{"saturation":"-41"},{"color":"#c8c8c8"}]},{"featureType":"transit","elementType":"all","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"all","stylers":[{"color":"#ffffff"},{"visibility":"on"}]},{"featureType":"water","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"color":"#a5a5aa"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"lightness":"100"},{"gamma":"1.13"},{"saturation":"-96"},{"visibility":"on"},{"color":"#eff0f6"},{"weight":"0.01"}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"lightness":"74"}]},{"featureType":"water","elementType":"labels.text.stroke","stylers":[{"visibility":"on"}]}];
    }

    $( document ).ready(function() {

        jQuery.get('/cfg/' + user_id, function(data, status) {

            loadMarkdown("/static/info.md", "#sidebar");
            loadMarkdown("/static/thanks.md", "#thank-you");

            var map = new L.Map('map', {

                        center: new L.LatLng(
                                data.config.center.lng,
                                data.config.center.lat
                        ),
                        zoom: data.config.zoom,
                        editable: true});

            var ggl = new L.Google('ROADMAP', { mapOptions: {styles : getStyles()}});
            map.addLayer(ggl);

            console.log(map.editTools);

            sidebar = loadSidebar(map);
            loadEditTools(map);
            addSearch(map);
            loadSaveAndClose(map);
            loadInformal(map);
        })
    });

</script>

</body>
</html>
