function loadEditTools(a){a.editTools.startPolyline(),a.on("editable:drawing:click",function(a){console.log(a.layer._latlngs),saveRoute(a.layer._latlngs)}),a.on("editable:vertex:dragend",function(a){console.log(a.layer._latlngs),saveRoute(a.layer._latlngs)})}function loadMarkdown(a,b){function c(a){var b=null;return $.ajax({url:a,type:"get",dataType:"html",async:!1,success:function(a){b=a}}),FileReady=!0,b}var d=new showdown.Converter,e=c(a),f=d.makeHtml(e);$(b).html(f)}function loadInformal(a){L.easyButton({id:"informal-button",states:[{onClick:function(a,b){sidebar.show()},icon:'<div class="informal-city-icon">&nbsp;</div>'}]}).addTo(a);$(".informal-city-icon").parent().parent().hide()}function loadSaveAndClose(a){L.easyButton('<div class="save-disk-icon" title="Save your route and close this window.">&nbsp;</div>',function(a,b){$("#map").fadeOut("slow"),$("#thank-you").fadeIn("slow"),b.editTools.stopDrawing()}).addTo(a)}function loadSidebar(a){var b=L.control.sidebar("sidebar",{position:"left"});return a.addControl(b),b.show(),b.on("hide",function(){$(".informal-city-icon").parent().parent().fadeIn()}),b.on("show",function(){$(".informal-city-icon").parent().parent().fadeOut()}),b}function addSearch(a){a.addControl(new L.Control.Search({url:"http://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",propertyName:"display_name",propertyLoc:["lat","lon"],circleLocation:!1,markerLocation:!1,autoType:!0,autoCollapse:!0,minLength:2,zoom:10}))}function saveRoute(a){var b=[];for(var c in a)b.push({lat:a[c].lat,lng:a[c].lng});$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"save_route",data:JSON.stringify({polyline:b,user_id:user_id}),success:function(a){console.log(a)},dataType:"json"})}function getStyles(){return[{featureType:"administrative",elementType:"geometry.stroke",stylers:[{visibility:"on"},{color:"#ababab"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{lightness:"59"}]},{featureType:"administrative.country",elementType:"labels.text",stylers:[{lightness:"50"},{color:"#7e7e85"},{weight:"0.21"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{weight:"0.5"},{color:"#afafaf"},{visibility:"on"}]},{featureType:"administrative.province",elementType:"labels.text",stylers:[{visibility:"off"},{color:"#7e7e85"}]},{featureType:"administrative.province",elementType:"labels.text.fill",stylers:[{color:"#7e7e85"}]},{featureType:"administrative.locality",elementType:"labels.text",stylers:[{visibility:"on"},{lightness:"59"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{lightness:"-39"}]},{featureType:"administrative.locality",elementType:"labels.icon",stylers:[{lightness:"48"},{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{visibility:"off"},{color:"#c4c4c7"}]},{featureType:"administrative.land_parcel",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape.natural.terrain",elementType:"labels.text",stylers:[{color:"#ff0000"},{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#eaeaea"},{weight:".5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{weight:".75"},{color:"#e4e3e3"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"on"},{lightness:"20"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{weight:"0.49"}]},{featureType:"road.arterial",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{lightness:"43"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{visibility:"on"},{saturation:"-41"},{color:"#c8c8c8"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#ffffff"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#a5a5aa"}]},{featureType:"water",elementType:"labels.text",stylers:[{lightness:"100"},{gamma:"1.13"},{saturation:"-96"},{visibility:"on"},{color:"#eff0f6"},{weight:"0.01"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:"74"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{visibility:"on"}]}]}var drawnItems,map,sidebar,data,map;